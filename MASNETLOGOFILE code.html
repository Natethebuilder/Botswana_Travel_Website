<pre><font color="#007f69">breed</font><font color="#000000"> [people person]<br /><br /></font><font color="#007f69">turtles-own</font><font color="#000000"> [<br />  group                      </font><font color="#5a5a5a">; Group A to F, representing ethnic groups</font><font color="#000000"><br />  prejudice                  </font><font color="#5a5a5a">; Prejudice level towards other groups (0 to 100)</font><font color="#000000"><br />  economic-status            </font><font color="#5a5a5a">; Economic status of each agent (0-100 scale)</font><font color="#000000"><br />  location                   </font><font color="#5a5a5a">; Neighborhood or area where the agent lives</font><font color="#000000"><br />  age                        </font><font color="#5a5a5a">; Age for youth socialization</font><font color="#000000"><br />  ptr                        </font><font color="#5a5a5a">; Probability to reproduce</font><font color="#000000"><br />  cooperate-with-same?       </font><font color="#5a5a5a">; Cooperation strategy with the same group</font><font color="#000000"><br />  cooperate-with-different?  </font><font color="#5a5a5a">; Cooperation strategy with other groups</font><font color="#000000"><br />]<br /><br /></font><font color="#007f69">globals</font><font color="#000000"> [<br />  meet                             </font><font color="#5a5a5a">; Total interactions this turn</font><font color="#000000"><br />  meet-agg                         </font><font color="#5a5a5a">; Total interactions through the run</font><font color="#000000"><br />  coopown                          </font><font color="#5a5a5a">; Cooperation with same group this turn</font><font color="#000000"><br />  coopown-agg                      </font><font color="#5a5a5a">; Total cooperation with same group through the run</font><font color="#000000"><br />  coopother                        </font><font color="#5a5a5a">; Cooperation with other groups this turn</font><font color="#000000"><br />  coopother-agg                    </font><font color="#5a5a5a">; Total cooperation with other groups through the run</font><font color="#000000"><br />  defother                         </font><font color="#5a5a5a">; Defection with other groups this turn</font><font color="#000000"><br />  defother-agg                     </font><font color="#5a5a5a">; Total defection with other groups through the run</font><font color="#000000"><br />  defown                           </font><font color="#5a5a5a">; Defection within the same group this turn</font><font color="#000000"><br />  defown-agg                       </font><font color="#5a5a5a">; Total defection within the same group through the run</font><font color="#000000"><br /><br />  interventionStartTime            </font><font color="#5a5a5a">; Time when interventions start</font><font color="#000000"><br /><br />  </font><font color="#5a5a5a">; Intensity variables for each intervention</font><font color="#000000"><br />  legalPolicyIntensity             </font><font color="#5a5a5a">; Intensity of legal and policy reforms</font><font color="#000000"><br />  trainingIntensity                </font><font color="#5a5a5a">; Intensity of diversity/anti-prejudice training</font><font color="#000000"><br />  communityEventIntensity          </font><font color="#5a5a5a">; Intensity of community-based events</font><font color="#000000"><br />  economicIncentiveIntensity       </font><font color="#5a5a5a">; Intensity of economic incentives</font><font color="#000000"><br />  sharedResourceIntensity          </font><font color="#5a5a5a">; Intensity of shared resource management</font><font color="#000000"><br />  youthSocializationIntensity      </font><font color="#5a5a5a">; Intensity of youth socialization</font><font color="#000000"><br /><br />  avg-prejudice-group-A<br />  avg-prejudice-group-B<br />  avg-prejudice-group-C<br />  avg-prejudice-group-D<br />  avg-prejudice-group-E<br /><br />  current-environment              </font><font color="#5a5a5a">; Tracks current environment type</font><font color="#000000"><br />]<br /><br /><br /></font><font color="#5a5a5a">; ------------------------------</font><font color="#000000"><br /></font><font color="#5a5a5a">; Setup the simulation</font><font color="#000000"><br /></font><font color="#007f69">to</font><font color="#000000"> setup<br />  </font><font color="#0000aa">clear-all</font><font color="#000000"><br />  setup-environment<br />  setup-variables<br />  setup-people<br />  </font><font color="#0000aa">reset-ticks</font><font color="#000000"><br /></font><font color="#007f69">end</font><font color="#000000"><br /><br /></font><font color="#5a5a5a">; ------------------------------</font><font color="#000000"><br /></font><font color="#5a5a5a">; Setup the environment based on environmentType</font><font color="#000000"><br /></font><font color="#007f69">to</font><font color="#000000"> setup-environment<br />  </font><font color="#0000aa">if</font><font color="#000000"> environmentType </font><font color="#660096">=</font><font color="#000000"> </font><font color="#963700">0</font><font color="#000000"> [ </font><font color="#5a5a5a">; Fully Segregated with central gray area</font><font color="#000000"><br />    </font><font color="#0000aa">let</font><font color="#000000"> region-size </font><font color="#660096">floor</font><font color="#000000"> (</font><font color="#660096">max-pxcor</font><font color="#000000"> </font><font color="#660096">/</font><font color="#000000"> </font><font color="#963700">5</font><font color="#000000">) </font><font color="#5a5a5a">; Calculate size of each region</font><font color="#000000"><br /><br />    </font><font color="#0000aa">ask</font><font color="#000000"> </font><font color="#660096">patches</font><font color="#000000"> [<br />      </font><font color="#0000aa">if</font><font color="#000000"> </font><font color="#660096">pxcor</font><font color="#000000"> </font><font color="#660096">&lt;</font><font color="#000000"> region-size [ </font><font color="#0000aa">set</font><font color="#000000"> </font><font color="#660096">pcolor</font><font color="#000000"> </font><font color="#963700">pink</font><font color="#000000"> ] </font><font color="#5a5a5a">; Region for Group A</font><font color="#000000"><br />      </font><font color="#0000aa">if</font><font color="#000000"> </font><font color="#660096">pxcor</font><font color="#000000"> </font><font color="#660096">&gt;=</font><font color="#000000"> region-size </font><font color="#660096">and</font><font color="#000000"> </font><font color="#660096">pxcor</font><font color="#000000"> </font><font color="#660096">&lt;</font><font color="#000000"> region-size </font><font color="#660096">*</font><font color="#000000"> </font><font color="#963700">2</font><font color="#000000"> [ </font><font color="#0000aa">set</font><font color="#000000"> </font><font color="#660096">pcolor</font><font color="#000000"> </font><font color="#963700">sky</font><font color="#000000"> ] </font><font color="#5a5a5a">; Region for Group B</font><font color="#000000"><br />      </font><font color="#0000aa">if</font><font color="#000000"> </font><font color="#660096">pxcor</font><font color="#000000"> </font><font color="#660096">&gt;=</font><font color="#000000"> region-size </font><font color="#660096">*</font><font color="#000000"> </font><font color="#963700">2</font><font color="#000000"> </font><font color="#660096">and</font><font color="#000000"> </font><font color="#660096">pxcor</font><font color="#000000"> </font><font color="#660096">&lt;</font><font color="#000000"> region-size </font><font color="#660096">*</font><font color="#000000"> </font><font color="#963700">3</font><font color="#000000"> [ </font><font color="#0000aa">set</font><font color="#000000"> </font><font color="#660096">pcolor</font><font color="#000000"> </font><font color="#963700">lime</font><font color="#000000"> ] </font><font color="#5a5a5a">; Region for Group C</font><font color="#000000"><br />      </font><font color="#0000aa">if</font><font color="#000000"> </font><font color="#660096">pxcor</font><font color="#000000"> </font><font color="#660096">&gt;=</font><font color="#000000"> region-size </font><font color="#660096">*</font><font color="#000000"> </font><font color="#963700">3</font><font color="#000000"> </font><font color="#660096">and</font><font color="#000000"> </font><font color="#660096">pxcor</font><font color="#000000"> </font><font color="#660096">&lt;</font><font color="#000000"> region-size </font><font color="#660096">*</font><font color="#000000"> </font><font color="#963700">4</font><font color="#000000"> [ </font><font color="#0000aa">set</font><font color="#000000"> </font><font color="#660096">pcolor</font><font color="#000000"> </font><font color="#963700">yellow</font><font color="#000000"> ] </font><font color="#5a5a5a">; Region for Group D</font><font color="#000000"><br />      </font><font color="#0000aa">if</font><font color="#000000"> </font><font color="#660096">pxcor</font><font color="#000000"> </font><font color="#660096">&gt;=</font><font color="#000000"> region-size </font><font color="#660096">*</font><font color="#000000"> </font><font color="#963700">4</font><font color="#000000"> [ </font><font color="#0000aa">set</font><font color="#000000"> </font><font color="#660096">pcolor</font><font color="#000000"> </font><font color="#963700">orange</font><font color="#000000"> ] </font><font color="#5a5a5a">; Region for Group E</font><font color="#000000"><br /><br />      </font><font color="#5a5a5a">; Define the central meeting area (gray)</font><font color="#000000"><br />     </font><font color="#0000aa">if</font><font color="#000000"> </font><font color="#660096">abs</font><font color="#000000">(</font><font color="#660096">pycor</font><font color="#000000">) </font><font color="#660096">&lt;=</font><font color="#000000"> region-size </font><font color="#660096">/</font><font color="#000000"> </font><font color="#963700">3</font><font color="#000000"> </font><font color="#660096">and</font><font color="#000000"> </font><font color="#660096">pxcor</font><font color="#000000"> </font><font color="#660096">&gt;=</font><font color="#000000"> region-size </font><font color="#660096">*</font><font color="#000000"> </font><font color="#963700">2</font><font color="#000000"> </font><font color="#660096">and</font><font color="#000000"> </font><font color="#660096">pxcor</font><font color="#000000"> </font><font color="#660096">&lt;</font><font color="#000000"> region-size </font><font color="#660096">*</font><font color="#000000"> </font><font color="#963700">3</font><font color="#000000"> [<br />  </font><font color="#0000aa">set</font><font color="#000000"> </font><font color="#660096">pcolor</font><font color="#000000"> </font><font color="#963700">gray</font><font color="#000000"><br /><br /><br />      ]<br />    ]<br /><br />    </font><font color="#5a5a5a">; Place agents in their respective regions</font><font color="#000000"><br />    </font><font color="#0000aa">ask</font><font color="#000000"> people [<br />      </font><font color="#0000aa">if</font><font color="#000000"> group </font><font color="#660096">=</font><font color="#000000"> </font><font color="#963700">&quot;A&quot;</font><font color="#000000"> [ </font><font color="#0000aa">move-to</font><font color="#000000"> </font><font color="#660096">one-of</font><font color="#000000"> </font><font color="#660096">patches</font><font color="#000000"> </font><font color="#660096">with</font><font color="#000000"> [</font><font color="#660096">pcolor</font><font color="#000000"> </font><font color="#660096">=</font><font color="#000000"> </font><font color="#963700">pink</font><font color="#000000">] ]<br />      </font><font color="#0000aa">if</font><font color="#000000"> group </font><font color="#660096">=</font><font color="#000000"> </font><font color="#963700">&quot;B&quot;</font><font color="#000000"> [ </font><font color="#0000aa">move-to</font><font color="#000000"> </font><font color="#660096">one-of</font><font color="#000000"> </font><font color="#660096">patches</font><font color="#000000"> </font><font color="#660096">with</font><font color="#000000"> [</font><font color="#660096">pcolor</font><font color="#000000"> </font><font color="#660096">=</font><font color="#000000"> </font><font color="#963700">sky</font><font color="#000000">] ]<br />      </font><font color="#0000aa">if</font><font color="#000000"> group </font><font color="#660096">=</font><font color="#000000"> </font><font color="#963700">&quot;C&quot;</font><font color="#000000"> [ </font><font color="#0000aa">move-to</font><font color="#000000"> </font><font color="#660096">one-of</font><font color="#000000"> </font><font color="#660096">patches</font><font color="#000000"> </font><font color="#660096">with</font><font color="#000000"> [</font><font color="#660096">pcolor</font><font color="#000000"> </font><font color="#660096">=</font><font color="#000000"> </font><font color="#963700">lime</font><font color="#000000">] ]<br />      </font><font color="#0000aa">if</font><font color="#000000"> group </font><font color="#660096">=</font><font color="#000000"> </font><font color="#963700">&quot;D&quot;</font><font color="#000000"> [ </font><font color="#0000aa">move-to</font><font color="#000000"> </font><font color="#660096">one-of</font><font color="#000000"> </font><font color="#660096">patches</font><font color="#000000"> </font><font color="#660096">with</font><font color="#000000"> [</font><font color="#660096">pcolor</font><font color="#000000"> </font><font color="#660096">=</font><font color="#000000"> </font><font color="#963700">yellow</font><font color="#000000">] ]<br />      </font><font color="#0000aa">if</font><font color="#000000"> group </font><font color="#660096">=</font><font color="#000000"> </font><font color="#963700">&quot;E&quot;</font><font color="#000000"> [ </font><font color="#0000aa">move-to</font><font color="#000000"> </font><font color="#660096">one-of</font><font color="#000000"> </font><font color="#660096">patches</font><font color="#000000"> </font><font color="#660096">with</font><font color="#000000"> [</font><font color="#660096">pcolor</font><font color="#000000"> </font><font color="#660096">=</font><font color="#000000"> </font><font color="#963700">orange</font><font color="#000000">] ]<br />    ]<br />  ]<br /><br />  </font><font color="#0000aa">if</font><font color="#000000"> environmentType </font><font color="#660096">=</font><font color="#000000"> </font><font color="#963700">1</font><font color="#000000"> [ </font><font color="#5a5a5a">; Fully Mixed</font><font color="#000000"><br />    </font><font color="#0000aa">ask</font><font color="#000000"> </font><font color="#660096">patches</font><font color="#000000"> [ </font><font color="#0000aa">set</font><font color="#000000"> </font><font color="#660096">pcolor</font><font color="#000000"> </font><font color="#963700">gray</font><font color="#000000"> ]<br />    </font><font color="#0000aa">ask</font><font color="#000000"> people [ </font><font color="#0000aa">move-to</font><font color="#000000"> </font><font color="#660096">one-of</font><font color="#000000"> </font><font color="#660096">patches</font><font color="#000000"> ]<br />  ]<br /><br />  </font><font color="#0000aa">if</font><font color="#000000"> environmentType </font><font color="#660096">=</font><font color="#000000"> </font><font color="#963700">2</font><font color="#000000"> [ </font><font color="#5a5a5a">; Partial Segregation</font><font color="#000000"><br />    </font><font color="#0000aa">let</font><font color="#000000"> region-size </font><font color="#660096">floor</font><font color="#000000"> (</font><font color="#660096">max-pxcor</font><font color="#000000"> </font><font color="#660096">/</font><font color="#000000"> </font><font color="#963700">5</font><font color="#000000">)<br /><br />    </font><font color="#0000aa">ask</font><font color="#000000"> </font><font color="#660096">patches</font><font color="#000000"> [<br />      </font><font color="#0000aa">if</font><font color="#000000"> </font><font color="#660096">pxcor</font><font color="#000000"> </font><font color="#660096">&lt;</font><font color="#000000"> region-size [ </font><font color="#0000aa">set</font><font color="#000000"> </font><font color="#660096">pcolor</font><font color="#000000"> </font><font color="#963700">pink</font><font color="#000000"> ]<br />      </font><font color="#0000aa">if</font><font color="#000000"> </font><font color="#660096">pxcor</font><font color="#000000"> </font><font color="#660096">&gt;=</font><font color="#000000"> region-size </font><font color="#660096">and</font><font color="#000000"> </font><font color="#660096">pxcor</font><font color="#000000"> </font><font color="#660096">&lt;</font><font color="#000000"> region-size </font><font color="#660096">*</font><font color="#000000"> </font><font color="#963700">2</font><font color="#000000"> [ </font><font color="#0000aa">set</font><font color="#000000"> </font><font color="#660096">pcolor</font><font color="#000000"> </font><font color="#963700">sky</font><font color="#000000"> ]<br />      </font><font color="#0000aa">if</font><font color="#000000"> </font><font color="#660096">pxcor</font><font color="#000000"> </font><font color="#660096">&gt;=</font><font color="#000000"> region-size </font><font color="#660096">*</font><font color="#000000"> </font><font color="#963700">2</font><font color="#000000"> </font><font color="#660096">and</font><font color="#000000"> </font><font color="#660096">pxcor</font><font color="#000000"> </font><font color="#660096">&lt;</font><font color="#000000"> region-size </font><font color="#660096">*</font><font color="#000000"> </font><font color="#963700">3</font><font color="#000000"> [ </font><font color="#0000aa">set</font><font color="#000000"> </font><font color="#660096">pcolor</font><font color="#000000"> </font><font color="#963700">lime</font><font color="#000000"> ]<br />      </font><font color="#0000aa">if</font><font color="#000000"> </font><font color="#660096">pxcor</font><font color="#000000"> </font><font color="#660096">&gt;=</font><font color="#000000"> region-size </font><font color="#660096">*</font><font color="#000000"> </font><font color="#963700">3</font><font color="#000000"> </font><font color="#660096">and</font><font color="#000000"> </font><font color="#660096">pxcor</font><font color="#000000"> </font><font color="#660096">&lt;</font><font color="#000000"> region-size </font><font color="#660096">*</font><font color="#000000"> </font><font color="#963700">4</font><font color="#000000"> [ </font><font color="#0000aa">set</font><font color="#000000"> </font><font color="#660096">pcolor</font><font color="#000000"> </font><font color="#963700">yellow</font><font color="#000000"> ]<br />      </font><font color="#0000aa">if</font><font color="#000000"> </font><font color="#660096">pxcor</font><font color="#000000"> </font><font color="#660096">&gt;=</font><font color="#000000"> region-size </font><font color="#660096">*</font><font color="#000000"> </font><font color="#963700">4</font><font color="#000000"> [ </font><font color="#0000aa">set</font><font color="#000000"> </font><font color="#660096">pcolor</font><font color="#000000"> </font><font color="#963700">orange</font><font color="#000000"> ]<br /><br />      </font><font color="#0000aa">if</font><font color="#000000"> </font><font color="#660096">abs</font><font color="#000000">(</font><font color="#660096">pycor</font><font color="#000000">) </font><font color="#660096">&lt;=</font><font color="#000000"> region-size </font><font color="#660096">/</font><font color="#000000"> </font><font color="#963700">2</font><font color="#000000"> </font><font color="#660096">and</font><font color="#000000"> </font><font color="#660096">pxcor</font><font color="#000000"> </font><font color="#660096">&gt;=</font><font color="#000000"> region-size </font><font color="#660096">*</font><font color="#000000"> </font><font color="#963700">2</font><font color="#000000"> </font><font color="#660096">and</font><font color="#000000"> </font><font color="#660096">pxcor</font><font color="#000000"> </font><font color="#660096">&lt;</font><font color="#000000"> region-size </font><font color="#660096">*</font><font color="#000000"> </font><font color="#963700">3</font><font color="#000000"> [<br />        </font><font color="#0000aa">set</font><font color="#000000"> </font><font color="#660096">pcolor</font><font color="#000000"> </font><font color="#963700">gray</font><font color="#000000"><br />      ]<br />    ]<br /><br />    </font><font color="#0000aa">ask</font><font color="#000000"> people [<br />      </font><font color="#0000aa">let</font><font color="#000000"> stay-segregated </font><font color="#660096">random-float</font><font color="#000000"> </font><font color="#963700">100</font><font color="#000000"> </font><font color="#660096">&lt;</font><font color="#000000"> </font><font color="#963700">70</font><font color="#000000"><br />      </font><font color="#0000aa">if</font><font color="#000000"> stay-segregated [<br />        </font><font color="#0000aa">if</font><font color="#000000"> group </font><font color="#660096">=</font><font color="#000000"> </font><font color="#963700">&quot;A&quot;</font><font color="#000000"> [ </font><font color="#0000aa">move-to</font><font color="#000000"> </font><font color="#660096">one-of</font><font color="#000000"> </font><font color="#660096">patches</font><font color="#000000"> </font><font color="#660096">with</font><font color="#000000"> [</font><font color="#660096">pcolor</font><font color="#000000"> </font><font color="#660096">=</font><font color="#000000"> </font><font color="#963700">pink</font><font color="#000000">] ]<br />        </font><font color="#0000aa">if</font><font color="#000000"> group </font><font color="#660096">=</font><font color="#000000"> </font><font color="#963700">&quot;B&quot;</font><font color="#000000"> [ </font><font color="#0000aa">move-to</font><font color="#000000"> </font><font color="#660096">one-of</font><font color="#000000"> </font><font color="#660096">patches</font><font color="#000000"> </font><font color="#660096">with</font><font color="#000000"> [</font><font color="#660096">pcolor</font><font color="#000000"> </font><font color="#660096">=</font><font color="#000000"> </font><font color="#963700">sky</font><font color="#000000">] ]<br />        </font><font color="#0000aa">if</font><font color="#000000"> group </font><font color="#660096">=</font><font color="#000000"> </font><font color="#963700">&quot;C&quot;</font><font color="#000000"> [ </font><font color="#0000aa">move-to</font><font color="#000000"> </font><font color="#660096">one-of</font><font color="#000000"> </font><font color="#660096">patches</font><font color="#000000"> </font><font color="#660096">with</font><font color="#000000"> [</font><font color="#660096">pcolor</font><font color="#000000"> </font><font color="#660096">=</font><font color="#000000"> </font><font color="#963700">lime</font><font color="#000000">] ]<br />        </font><font color="#0000aa">if</font><font color="#000000"> group </font><font color="#660096">=</font><font color="#000000"> </font><font color="#963700">&quot;D&quot;</font><font color="#000000"> [ </font><font color="#0000aa">move-to</font><font color="#000000"> </font><font color="#660096">one-of</font><font color="#000000"> </font><font color="#660096">patches</font><font color="#000000"> </font><font color="#660096">with</font><font color="#000000"> [</font><font color="#660096">pcolor</font><font color="#000000"> </font><font color="#660096">=</font><font color="#000000"> </font><font color="#963700">yellow</font><font color="#000000">] ]<br />        </font><font color="#0000aa">if</font><font color="#000000"> group </font><font color="#660096">=</font><font color="#000000"> </font><font color="#963700">&quot;E&quot;</font><font color="#000000"> [ </font><font color="#0000aa">move-to</font><font color="#000000"> </font><font color="#660096">one-of</font><font color="#000000"> </font><font color="#660096">patches</font><font color="#000000"> </font><font color="#660096">with</font><font color="#000000"> [</font><font color="#660096">pcolor</font><font color="#000000"> </font><font color="#660096">=</font><font color="#000000"> </font><font color="#963700">orange</font><font color="#000000">] ]<br />      ]<br />      </font><font color="#0000aa">if</font><font color="#000000"> </font><font color="#660096">not</font><font color="#000000"> stay-segregated [ </font><font color="#0000aa">move-to</font><font color="#000000"> </font><font color="#660096">one-of</font><font color="#000000"> </font><font color="#660096">patches</font><font color="#000000"> ] </font><font color="#5a5a5a">; Free movement for 30%</font><font color="#000000"><br />    ]<br />  ]<br /></font><font color="#007f69">end</font><font color="#000000"><br /><br /><br /><br /></font><font color="#5a5a5a">; ------------------------------</font><font color="#000000"><br /></font><font color="#5a5a5a">; Setup variables and agents</font><font color="#000000"><br /></font><font color="#007f69">to</font><font color="#000000"> setup-variables<br />  </font><font color="#0000aa">set</font><font color="#000000"> meet </font><font color="#963700">0</font><font color="#000000"><br />  </font><font color="#0000aa">set</font><font color="#000000"> meet-agg </font><font color="#963700">0</font><font color="#000000"><br />  </font><font color="#0000aa">set</font><font color="#000000"> coopown </font><font color="#963700">0</font><font color="#000000"><br />  </font><font color="#0000aa">set</font><font color="#000000"> coopown-agg </font><font color="#963700">0</font><font color="#000000"><br />  </font><font color="#0000aa">set</font><font color="#000000"> coopother </font><font color="#963700">0</font><font color="#000000"><br />  </font><font color="#0000aa">set</font><font color="#000000"> coopother-agg </font><font color="#963700">0</font><font color="#000000"><br />  </font><font color="#0000aa">set</font><font color="#000000"> defother </font><font color="#963700">0</font><font color="#000000"><br />  </font><font color="#0000aa">set</font><font color="#000000"> defother-agg </font><font color="#963700">0</font><font color="#000000"><br /></font><font color="#007f69">end</font><font color="#000000"><br /><br /></font><font color="#007f69">to</font><font color="#000000"> setup-people<br />  create-people </font><font color="#963700">100</font><font color="#000000"> [<br />    </font><font color="#0000aa">setxy</font><font color="#000000"> </font><font color="#660096">random-xcor</font><font color="#000000"> </font><font color="#660096">random-ycor</font><font color="#000000"><br />    </font><font color="#0000aa">set</font><font color="#000000"> group </font><font color="#660096">one-of</font><font color="#000000"> [</font><font color="#963700">&quot;A&quot;</font><font color="#000000"> </font><font color="#963700">&quot;B&quot;</font><font color="#000000"> </font><font color="#963700">&quot;C&quot;</font><font color="#000000"> </font><font color="#963700">&quot;D&quot;</font><font color="#000000"> </font><font color="#963700">&quot;E&quot;</font><font color="#000000">]<br />    </font><font color="#0000aa">set</font><font color="#000000"> prejudice </font><font color="#660096">random</font><font color="#000000"> </font><font color="#963700">50</font><font color="#000000"><br />    </font><font color="#0000aa">set</font><font color="#000000"> economic-status </font><font color="#660096">random-float</font><font color="#000000"> </font><font color="#963700">100</font><font color="#000000"><br />    </font><font color="#0000aa">set</font><font color="#000000"> age </font><font color="#660096">random</font><font color="#000000"> </font><font color="#963700">100</font><font color="#000000"><br />    </font><font color="#0000aa">set</font><font color="#000000"> ptr </font><font color="#963700">0.5</font><font color="#000000"><br />    </font><font color="#0000aa">set</font><font color="#000000"> cooperate-with-same? (</font><font color="#660096">random</font><font color="#000000"> </font><font color="#963700">2</font><font color="#000000"> </font><font color="#660096">=</font><font color="#000000"> </font><font color="#963700">0</font><font color="#000000">)<br />    </font><font color="#0000aa">set</font><font color="#000000"> cooperate-with-different? (</font><font color="#660096">random</font><font color="#000000"> </font><font color="#963700">2</font><font color="#000000"> </font><font color="#660096">=</font><font color="#000000"> </font><font color="#963700">0</font><font color="#000000">)<br />  ]<br />  update-shape<br /></font><font color="#007f69">end</font><font color="#000000"><br /><br /></font><font color="#5a5a5a">; ------------------------------</font><font color="#000000"><br /></font><font color="#5a5a5a">; Update shapes dynamically</font><font color="#000000"><br /></font><font color="#007f69">to</font><font color="#000000"> update-shape<br />  </font><font color="#0000aa">ask</font><font color="#000000"> people [<br />    </font><font color="#0000aa">if</font><font color="#000000"> group </font><font color="#660096">=</font><font color="#000000"> </font><font color="#963700">&quot;A&quot;</font><font color="#000000"> [ </font><font color="#0000aa">set</font><font color="#000000"> </font><font color="#660096">shape</font><font color="#000000"> </font><font color="#963700">&quot;circle&quot;</font><font color="#000000"> </font><font color="#0000aa">set</font><font color="#000000"> </font><font color="#660096">color</font><font color="#000000"> </font><font color="#963700">red</font><font color="#000000"> ]       </font><font color="#5a5a5a">; Group A → Pink region</font><font color="#000000"><br />    </font><font color="#0000aa">if</font><font color="#000000"> group </font><font color="#660096">=</font><font color="#000000"> </font><font color="#963700">&quot;B&quot;</font><font color="#000000"> [ </font><font color="#0000aa">set</font><font color="#000000"> </font><font color="#660096">shape</font><font color="#000000"> </font><font color="#963700">&quot;square&quot;</font><font color="#000000"> </font><font color="#0000aa">set</font><font color="#000000"> </font><font color="#660096">color</font><font color="#000000"> </font><font color="#963700">blue</font><font color="#000000"> ]      </font><font color="#5a5a5a">; Group B → Sky region</font><font color="#000000"><br />    </font><font color="#0000aa">if</font><font color="#000000"> group </font><font color="#660096">=</font><font color="#000000"> </font><font color="#963700">&quot;C&quot;</font><font color="#000000"> [ </font><font color="#0000aa">set</font><font color="#000000"> </font><font color="#660096">shape</font><font color="#000000"> </font><font color="#963700">&quot;triangle&quot;</font><font color="#000000"> </font><font color="#0000aa">set</font><font color="#000000"> </font><font color="#660096">color</font><font color="#000000"> </font><font color="#963700">green</font><font color="#000000"> ]   </font><font color="#5a5a5a">; Group C → Lime region</font><font color="#000000"><br />    </font><font color="#0000aa">if</font><font color="#000000"> group </font><font color="#660096">=</font><font color="#000000"> </font><font color="#963700">&quot;D&quot;</font><font color="#000000"> [ </font><font color="#0000aa">set</font><font color="#000000"> </font><font color="#660096">shape</font><font color="#000000"> </font><font color="#963700">&quot;star&quot;</font><font color="#000000"> </font><font color="#0000aa">set</font><font color="#000000"> </font><font color="#660096">color</font><font color="#000000"> </font><font color="#963700">black</font><font color="#000000"> ]       </font><font color="#5a5a5a">; Group D → Yellow region</font><font color="#000000"><br />    </font><font color="#0000aa">if</font><font color="#000000"> group </font><font color="#660096">=</font><font color="#000000"> </font><font color="#963700">&quot;E&quot;</font><font color="#000000"> [ </font><font color="#0000aa">set</font><font color="#000000"> </font><font color="#660096">shape</font><font color="#000000"> </font><font color="#963700">&quot;person&quot;</font><font color="#000000"> </font><font color="#0000aa">set</font><font color="#000000"> </font><font color="#660096">color</font><font color="#000000"> </font><font color="#963700">violet</font><font color="#000000"> ]    </font><font color="#5a5a5a">; Group E → Orange region</font><font color="#000000"><br />  ]<br /></font><font color="#007f69">end</font><font color="#000000"><br /><br /></font><font color="#5a5a5a">; ------------------------------</font><font color="#000000"><br /></font><font color="#5a5a5a">; Main simulation loop</font><font color="#000000"><br /></font><font color="#007f69">to</font><font color="#000000"> go<br />  </font><font color="#5a5a5a">; Sync sliders to global variables</font><font color="#000000"><br />  </font><font color="#0000aa">set</font><font color="#000000"> interventionStartTime slider_interventionStartTime<br />  </font><font color="#0000aa">set</font><font color="#000000"> legalPolicyIntensity slider_legalPolicyIntensity<br />  </font><font color="#0000aa">set</font><font color="#000000"> trainingIntensity slider_trainingIntensity<br />  </font><font color="#0000aa">set</font><font color="#000000"> communityEventIntensity slider_communityEventIntensity<br />  </font><font color="#0000aa">set</font><font color="#000000"> economicIncentiveIntensity slider_economicIncentiveIntensity<br />  </font><font color="#0000aa">set</font><font color="#000000"> sharedResourceIntensity slider_sharedResourceIntensity<br />  </font><font color="#0000aa">set</font><font color="#000000"> youthSocializationIntensity slider_youthSocializationIntensity<br /><br />  </font><font color="#5a5a5a">; Movement constraints</font><font color="#000000"><br />  </font><font color="#0000aa">if</font><font color="#000000"> environmentType </font><font color="#660096">=</font><font color="#000000"> </font><font color="#963700">0</font><font color="#000000"> [<br />    </font><font color="#0000aa">ask</font><font color="#000000"> people [ move-within-region ]<br />  ]<br /><br />  </font><font color="#0000aa">if</font><font color="#000000"> environmentType </font><font color="#660096">=</font><font color="#000000"> </font><font color="#963700">1</font><font color="#000000"> [<br />    </font><font color="#0000aa">ask</font><font color="#000000"> people [ move-around ]<br />  ]<br /><br />  </font><font color="#0000aa">if</font><font color="#000000"> environmentType </font><font color="#660096">=</font><font color="#000000"> </font><font color="#963700">2</font><font color="#000000"> [<br />    </font><font color="#0000aa">ask</font><font color="#000000"> people [<br />      </font><font color="#0000aa">let</font><font color="#000000"> stay-segregated </font><font color="#660096">random-float</font><font color="#000000"> </font><font color="#963700">100</font><font color="#000000"> </font><font color="#660096">&lt;</font><font color="#000000"> </font><font color="#963700">70</font><font color="#000000"><br />      </font><font color="#0000aa">if</font><font color="#000000"> stay-segregated [ move-within-region ]<br />      </font><font color="#0000aa">if</font><font color="#000000"> </font><font color="#660096">not</font><font color="#000000"> stay-segregated [ move-around ]<br />    ]<br />  ]<br /><br />  clear-stats<br />  </font><font color="#0000aa">ask</font><font color="#000000"> people [<br />    interact<br />    update-prejudice<br />  ]<br />   </font><font color="#5a5a5a">; Prevent unintended defection increments in environment 0</font><font color="#000000"><br />  </font><font color="#0000aa">if</font><font color="#000000"> environmentType </font><font color="#660096">=</font><font color="#000000"> </font><font color="#963700">0</font><font color="#000000"> </font><font color="#660096">and</font><font color="#000000"> communityEventIntensity </font><font color="#660096">=</font><font color="#000000"> </font><font color="#963700">0</font><font color="#000000"> </font><font color="#660096">and</font><font color="#000000"> sharedResourceIntensity </font><font color="#660096">=</font><font color="#000000"> </font><font color="#963700">0</font><font color="#000000"> </font><font color="#660096">and</font><font color="#000000"> youthSocializationIntensity </font><font color="#660096">=</font><font color="#000000"> </font><font color="#963700">0</font><font color="#000000"> [<br />    </font><font color="#0000aa">set</font><font color="#000000"> defother </font><font color="#963700">0</font><font color="#000000"><br />  ]<br />  implement-interventions<br />  update-stats<br />  </font><font color="#0000aa">tick</font><font color="#000000"><br /></font><font color="#007f69">end</font><font color="#000000"><br /><br /></font><font color="#5a5a5a">; ------------------------------</font><font color="#000000"><br /></font><font color="#5a5a5a">; Movement logic for agents within their region</font><font color="#000000"><br /></font><font color="#007f69">to</font><font color="#000000"> move-within-region<br />  </font><font color="#0000aa">if</font><font color="#000000"> group </font><font color="#660096">=</font><font color="#000000"> </font><font color="#963700">&quot;A&quot;</font><font color="#000000"> [ </font><font color="#0000aa">move-to</font><font color="#000000"> </font><font color="#660096">one-of</font><font color="#000000"> </font><font color="#660096">patches</font><font color="#000000"> </font><font color="#660096">with</font><font color="#000000"> [</font><font color="#660096">pcolor</font><font color="#000000"> </font><font color="#660096">=</font><font color="#000000"> </font><font color="#963700">pink</font><font color="#000000">] ]<br />  </font><font color="#0000aa">if</font><font color="#000000"> group </font><font color="#660096">=</font><font color="#000000"> </font><font color="#963700">&quot;B&quot;</font><font color="#000000"> [ </font><font color="#0000aa">move-to</font><font color="#000000"> </font><font color="#660096">one-of</font><font color="#000000"> </font><font color="#660096">patches</font><font color="#000000"> </font><font color="#660096">with</font><font color="#000000"> [</font><font color="#660096">pcolor</font><font color="#000000"> </font><font color="#660096">=</font><font color="#000000"> </font><font color="#963700">sky</font><font color="#000000">] ]<br />  </font><font color="#0000aa">if</font><font color="#000000"> group </font><font color="#660096">=</font><font color="#000000"> </font><font color="#963700">&quot;C&quot;</font><font color="#000000"> [ </font><font color="#0000aa">move-to</font><font color="#000000"> </font><font color="#660096">one-of</font><font color="#000000"> </font><font color="#660096">patches</font><font color="#000000"> </font><font color="#660096">with</font><font color="#000000"> [</font><font color="#660096">pcolor</font><font color="#000000"> </font><font color="#660096">=</font><font color="#000000"> </font><font color="#963700">lime</font><font color="#000000">] ]<br />  </font><font color="#0000aa">if</font><font color="#000000"> group </font><font color="#660096">=</font><font color="#000000"> </font><font color="#963700">&quot;D&quot;</font><font color="#000000"> [ </font><font color="#0000aa">move-to</font><font color="#000000"> </font><font color="#660096">one-of</font><font color="#000000"> </font><font color="#660096">patches</font><font color="#000000"> </font><font color="#660096">with</font><font color="#000000"> [</font><font color="#660096">pcolor</font><font color="#000000"> </font><font color="#660096">=</font><font color="#000000"> </font><font color="#963700">yellow</font><font color="#000000">] ]<br />  </font><font color="#0000aa">if</font><font color="#000000"> group </font><font color="#660096">=</font><font color="#000000"> </font><font color="#963700">&quot;E&quot;</font><font color="#000000"> [ </font><font color="#0000aa">move-to</font><font color="#000000"> </font><font color="#660096">one-of</font><font color="#000000"> </font><font color="#660096">patches</font><font color="#000000"> </font><font color="#660096">with</font><font color="#000000"> [</font><font color="#660096">pcolor</font><font color="#000000"> </font><font color="#660096">=</font><font color="#000000"> </font><font color="#963700">orange</font><font color="#000000">] ]<br /></font><font color="#007f69">end</font><font color="#000000"><br /><br /></font><font color="#5a5a5a">; Movement logic for free movement</font><font color="#000000"><br /></font><font color="#007f69">to</font><font color="#000000"> move-around<br />  </font><font color="#0000aa">rt</font><font color="#000000"> </font><font color="#660096">random</font><font color="#000000"> </font><font color="#963700">360</font><font color="#000000"><br />  </font><font color="#0000aa">fd</font><font color="#000000"> </font><font color="#963700">1</font><font color="#000000"><br /></font><font color="#007f69">end</font><font color="#000000"><br /><br /></font><font color="#5a5a5a">; ------------------------------</font><font color="#000000"><br /></font><font color="#5a5a5a">; Interaction logic for cooperation and defection</font><font color="#000000"><br /></font><font color="#5a5a5a">; Interaction logic for cooperation and defection</font><font color="#000000"><br /></font><font color="#007f69">to</font><font color="#000000"> interact<br />  </font><font color="#0000aa">let</font><font color="#000000"> neighbor </font><font color="#660096">one-of</font><font color="#000000"> </font><font color="#660096">turtles</font><font color="#000000"> </font><font color="#660096">in-radius</font><font color="#000000"> </font><font color="#963700">1</font><font color="#000000"><br />  </font><font color="#0000aa">if</font><font color="#000000"> neighbor </font><font color="#660096">!=</font><font color="#000000"> </font><font color="#963700">nobody</font><font color="#000000"> [<br />    </font><font color="#0000aa">let</font><font color="#000000"> interaction-group [group] </font><font color="#660096">of</font><font color="#000000"> neighbor<br />    </font><font color="#0000aa">let</font><font color="#000000"> interaction-outcome </font><font color="#963700">0</font><font color="#000000"> </font><font color="#5a5a5a">; Default outcome is defection</font><font color="#000000"><br /><br />    </font><font color="#0000aa">if</font><font color="#000000"> environmentType </font><font color="#660096">=</font><font color="#000000"> </font><font color="#963700">0</font><font color="#000000"> [<br />      </font><font color="#5a5a5a">; Environment 0: Fully segregated</font><font color="#000000"><br />      </font><font color="#0000aa">if</font><font color="#000000"> group </font><font color="#660096">=</font><font color="#000000"> interaction-group [<br />        </font><font color="#5a5a5a">; Intra-group interactions only</font><font color="#000000"><br />        </font><font color="#0000aa">let</font><font color="#000000"> intra-group-defection-probability </font><font color="#963700">10</font><font color="#000000"> </font><font color="#5a5a5a">; 10% baseline defection probability</font><font color="#000000"><br />        </font><font color="#0000aa">if</font><font color="#000000"> </font><font color="#660096">random-float</font><font color="#000000"> </font><font color="#963700">100</font><font color="#000000"> </font><font color="#660096">&gt;</font><font color="#000000"> intra-group-defection-probability [<br />          </font><font color="#0000aa">set</font><font color="#000000"> interaction-outcome </font><font color="#963700">1</font><font color="#000000"> </font><font color="#5a5a5a">; Cooperation</font><font color="#000000"><br />        ]<br />      ]<br /><br />      </font><font color="#0000aa">if</font><font color="#000000"> group </font><font color="#660096">!=</font><font color="#000000"> interaction-group [<br />        </font><font color="#5a5a5a">; Forced inter-group interactions based on interventions</font><font color="#000000"><br />        </font><font color="#0000aa">let</font><font color="#000000"> forced-interaction? (<br />          (youthSocializationIntensity </font><font color="#660096">&gt;</font><font color="#000000"> </font><font color="#963700">0</font><font color="#000000"> </font><font color="#660096">and</font><font color="#000000"> age </font><font color="#660096">&lt;</font><font color="#000000"> </font><font color="#963700">18</font><font color="#000000">) </font><font color="#660096">or</font><font color="#000000"><br />          (sharedResourceIntensity </font><font color="#660096">&gt;</font><font color="#000000"> </font><font color="#963700">0</font><font color="#000000"> </font><font color="#660096">and</font><font color="#000000"> [</font><font color="#660096">pcolor</font><font color="#000000">] </font><font color="#660096">of</font><font color="#000000"> </font><font color="#660096">patch-here</font><font color="#000000"> </font><font color="#660096">=</font><font color="#000000"> </font><font color="#963700">gray</font><font color="#000000">) </font><font color="#660096">or</font><font color="#000000"><br />          (communityEventIntensity </font><font color="#660096">&gt;</font><font color="#000000"> </font><font color="#963700">0</font><font color="#000000"> </font><font color="#660096">and</font><font color="#000000"> [</font><font color="#660096">pcolor</font><font color="#000000">] </font><font color="#660096">of</font><font color="#000000"> </font><font color="#660096">patch-here</font><font color="#000000"> </font><font color="#660096">=</font><font color="#000000"> </font><font color="#963700">gray</font><font color="#000000">)<br />        )<br />        </font><font color="#0000aa">if</font><font color="#000000"> forced-interaction? [<br />          </font><font color="#0000aa">if</font><font color="#000000"> </font><font color="#660096">random-float</font><font color="#000000"> </font><font color="#963700">100</font><font color="#000000"> </font><font color="#660096">&gt;</font><font color="#000000"> prejudice [<br />            </font><font color="#0000aa">set</font><font color="#000000"> interaction-outcome </font><font color="#963700">1</font><font color="#000000"> </font><font color="#5a5a5a">; Cooperation</font><font color="#000000"><br />          ]<br />        ]<br />      ]<br />    ]<br /><br />    </font><font color="#0000aa">if</font><font color="#000000"> environmentType </font><font color="#660096">!=</font><font color="#000000"> </font><font color="#963700">0</font><font color="#000000"> [<br />      </font><font color="#5a5a5a">; Environments 1 and 2: Mixed or partially segregated</font><font color="#000000"><br />      </font><font color="#0000aa">if</font><font color="#000000"> group </font><font color="#660096">=</font><font color="#000000"> interaction-group [<br />        </font><font color="#5a5a5a">; Intra-group interactions</font><font color="#000000"><br />        </font><font color="#0000aa">let</font><font color="#000000"> intra-group-defection-probability </font><font color="#963700">10</font><font color="#000000"> </font><font color="#5a5a5a">; 10% baseline defection probability</font><font color="#000000"><br />        </font><font color="#0000aa">if</font><font color="#000000"> </font><font color="#660096">random-float</font><font color="#000000"> </font><font color="#963700">100</font><font color="#000000"> </font><font color="#660096">&gt;</font><font color="#000000"> intra-group-defection-probability [<br />          </font><font color="#0000aa">set</font><font color="#000000"> interaction-outcome </font><font color="#963700">1</font><font color="#000000"> </font><font color="#5a5a5a">; Cooperation</font><font color="#000000"><br />        ]<br />      ]<br />      </font><font color="#0000aa">if</font><font color="#000000"> group </font><font color="#660096">!=</font><font color="#000000"> interaction-group [<br />        </font><font color="#5a5a5a">; Inter-group interactions</font><font color="#000000"><br />        </font><font color="#0000aa">let</font><font color="#000000"> scaled-prejudice prejudice </font><font color="#660096">*</font><font color="#000000"> </font><font color="#963700">0.5</font><font color="#000000"> </font><font color="#5a5a5a">; Scale prejudice to reduce extreme effects</font><font color="#000000"><br />        </font><font color="#0000aa">if</font><font color="#000000"> </font><font color="#660096">random-float</font><font color="#000000"> </font><font color="#963700">100</font><font color="#000000"> </font><font color="#660096">&gt;</font><font color="#000000"> scaled-prejudice [<br />          </font><font color="#0000aa">set</font><font color="#000000"> interaction-outcome </font><font color="#963700">1</font><font color="#000000"> </font><font color="#5a5a5a">; Cooperation</font><font color="#000000"><br />        ]<br />      ]<br />    ]<br /><br />    </font><font color="#5a5a5a">; Update statistics</font><font color="#000000"><br />    </font><font color="#0000aa">if</font><font color="#000000"> interaction-outcome </font><font color="#660096">=</font><font color="#000000"> </font><font color="#963700">1</font><font color="#000000"> [<br />      </font><font color="#0000aa">if</font><font color="#000000"> group </font><font color="#660096">=</font><font color="#000000"> interaction-group [<br />        </font><font color="#0000aa">set</font><font color="#000000"> coopown coopown </font><font color="#660096">+</font><font color="#000000"> </font><font color="#963700">1</font><font color="#000000"><br />      ]<br />      </font><font color="#0000aa">if</font><font color="#000000"> group </font><font color="#660096">!=</font><font color="#000000"> interaction-group [<br />        </font><font color="#0000aa">set</font><font color="#000000"> coopother coopother </font><font color="#660096">+</font><font color="#000000"> </font><font color="#963700">1</font><font color="#000000"><br />      ]<br />    ]<br />    </font><font color="#0000aa">if</font><font color="#000000"> interaction-outcome </font><font color="#660096">=</font><font color="#000000"> </font><font color="#963700">0</font><font color="#000000"> [<br />      </font><font color="#0000aa">if</font><font color="#000000"> group </font><font color="#660096">=</font><font color="#000000"> interaction-group [<br />        </font><font color="#0000aa">set</font><font color="#000000"> defown defown </font><font color="#660096">+</font><font color="#000000"> </font><font color="#963700">1</font><font color="#000000"><br />      ]<br />      </font><font color="#0000aa">if</font><font color="#000000"> group </font><font color="#660096">!=</font><font color="#000000"> interaction-group [<br />        </font><font color="#0000aa">set</font><font color="#000000"> defother defother </font><font color="#660096">+</font><font color="#000000"> </font><font color="#963700">1</font><font color="#000000"><br />      ]<br />    ]<br /><br />    </font><font color="#5a5a5a">; Update prejudice based on interaction outcome</font><font color="#000000"><br />    </font><font color="#0000aa">if</font><font color="#000000"> interaction-outcome </font><font color="#660096">=</font><font color="#000000"> </font><font color="#963700">1</font><font color="#000000"> [<br />      </font><font color="#0000aa">set</font><font color="#000000"> prejudice prejudice </font><font color="#660096">-</font><font color="#000000"> </font><font color="#963700">2</font><font color="#000000"> </font><font color="#5a5a5a">; Cooperation reduces prejudice more significantly</font><font color="#000000"><br />    ]<br />    </font><font color="#0000aa">if</font><font color="#000000"> interaction-outcome </font><font color="#660096">=</font><font color="#000000"> </font><font color="#963700">0</font><font color="#000000"> [<br />      </font><font color="#0000aa">set</font><font color="#000000"> prejudice prejudice </font><font color="#660096">+</font><font color="#000000"> </font><font color="#963700">1</font><font color="#000000"> </font><font color="#5a5a5a">; Defection increases prejudice less significantly</font><font color="#000000"><br />    ]<br /><br />    </font><font color="#5a5a5a">; Cap prejudice to [0, 100]</font><font color="#000000"><br />    </font><font color="#0000aa">set</font><font color="#000000"> prejudice </font><font color="#660096">max</font><font color="#000000"> </font><font color="#660096">list</font><font color="#000000"> </font><font color="#963700">0</font><font color="#000000"> (</font><font color="#660096">min</font><font color="#000000"> </font><font color="#660096">list</font><font color="#000000"> </font><font color="#963700">100</font><font color="#000000"> prejudice)<br />  ]<br /></font><font color="#007f69">end</font><font color="#000000"><br /><br /><br /><br /><br /><br /><br /><br /><br /></font><font color="#5a5a5a">; ------------------------------</font><font color="#000000"><br /></font><font color="#5a5a5a">; Update prejudice based on interactions and interventions</font><font color="#000000"><br /></font><font color="#007f69">to</font><font color="#000000"> update-prejudice<br />  </font><font color="#0000aa">ask</font><font color="#000000"> people [<br />    </font><font color="#5a5a5a">; Natural prejudice increase</font><font color="#000000"><br />    </font><font color="#0000aa">if</font><font color="#000000"> </font><font color="#660096">random-float</font><font color="#000000"> </font><font color="#963700">100</font><font color="#000000"> </font><font color="#660096">&lt;</font><font color="#000000"> </font><font color="#963700">20</font><font color="#000000"> [ </font><font color="#5a5a5a">; 20% chance per tick for natural prejudice growth</font><font color="#000000"><br />      </font><font color="#0000aa">set</font><font color="#000000"> prejudice prejudice </font><font color="#660096">+</font><font color="#000000"> </font><font color="#963700">0.5</font><font color="#000000"><br />    ]<br /><br />    </font><font color="#5a5a5a">; Effects of interventions</font><font color="#000000"><br />    </font><font color="#0000aa">let</font><font color="#000000"> intervention-effect<br />      (legalPolicyIntensity </font><font color="#660096">/</font><font color="#000000"> </font><font color="#963700">100</font><font color="#000000"> </font><font color="#660096">*</font><font color="#000000"> </font><font color="#963700">0.2</font><font color="#000000">) </font><font color="#660096">+</font><font color="#000000"><br />      (trainingIntensity </font><font color="#660096">/</font><font color="#000000"> </font><font color="#963700">100</font><font color="#000000"> </font><font color="#660096">*</font><font color="#000000"> </font><font color="#963700">0.3</font><font color="#000000">) </font><font color="#660096">+</font><font color="#000000"><br />      (communityEventIntensity </font><font color="#660096">/</font><font color="#000000"> </font><font color="#963700">100</font><font color="#000000"> </font><font color="#660096">*</font><font color="#000000"> (</font><font color="#660096">count</font><font color="#000000"> </font><font color="#660096">turtles</font><font color="#000000"> </font><font color="#660096">in-radius</font><font color="#000000"> </font><font color="#963700">3</font><font color="#000000"> </font><font color="#660096">/</font><font color="#000000"> </font><font color="#963700">5</font><font color="#000000">)) </font><font color="#660096">+</font><font color="#000000"><br />      (economicIncentiveIntensity </font><font color="#660096">/</font><font color="#000000"> </font><font color="#963700">100</font><font color="#000000"> </font><font color="#660096">*</font><font color="#000000"> </font><font color="#660096">ifelse-value</font><font color="#000000"> (economic-status </font><font color="#660096">&lt;</font><font color="#000000"> </font><font color="#963700">50</font><font color="#000000">) [</font><font color="#963700">1</font><font color="#000000">] [</font><font color="#963700">0</font><font color="#000000">]) </font><font color="#660096">+</font><font color="#000000"><br />      (sharedResourceIntensity </font><font color="#660096">/</font><font color="#000000"> </font><font color="#963700">100</font><font color="#000000"> </font><font color="#660096">*</font><font color="#000000"> </font><font color="#963700">0.2</font><font color="#000000">) </font><font color="#660096">+</font><font color="#000000"><br />      (youthSocializationIntensity </font><font color="#660096">/</font><font color="#000000"> </font><font color="#963700">100</font><font color="#000000"> </font><font color="#660096">*</font><font color="#000000"> </font><font color="#660096">ifelse-value</font><font color="#000000"> (age </font><font color="#660096">&lt;</font><font color="#000000"> </font><font color="#963700">18</font><font color="#000000">) [</font><font color="#963700">1</font><font color="#000000">] [</font><font color="#963700">0</font><font color="#000000">])<br /><br />    </font><font color="#0000aa">set</font><font color="#000000"> prejudice prejudice </font><font color="#660096">*</font><font color="#000000"> (</font><font color="#963700">1</font><font color="#000000"> </font><font color="#660096">-</font><font color="#000000"> intervention-effect)<br /><br />    </font><font color="#5a5a5a">; Cap prejudice to [0, 100]</font><font color="#000000"><br />    </font><font color="#0000aa">set</font><font color="#000000"> prejudice </font><font color="#660096">max</font><font color="#000000"> </font><font color="#660096">list</font><font color="#000000"> </font><font color="#963700">0</font><font color="#000000"> (</font><font color="#660096">min</font><font color="#000000"> </font><font color="#660096">list</font><font color="#000000"> </font><font color="#963700">100</font><font color="#000000"> prejudice)<br />  ]<br /></font><font color="#007f69">end</font><font color="#000000"><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /></font><font color="#5a5a5a">; ------------------------------</font><font color="#000000"><br /></font><font color="#5a5a5a">; Implement all interventions</font><font color="#000000"><br /></font><font color="#007f69">to</font><font color="#000000"> implement-interventions<br />  </font><font color="#0000aa">if</font><font color="#000000"> </font><font color="#660096">ticks</font><font color="#000000"> </font><font color="#660096">&gt;=</font><font color="#000000"> interventionStartTime [<br />    </font><font color="#0000aa">ask</font><font color="#000000"> people </font><font color="#660096">with</font><font color="#000000"> [prejudice </font><font color="#660096">&gt;</font><font color="#000000"> </font><font color="#963700">50</font><font color="#000000">] [<br />      </font><font color="#0000aa">set</font><font color="#000000"> prejudice prejudice </font><font color="#660096">*</font><font color="#000000"> (</font><font color="#963700">1</font><font color="#000000"> </font><font color="#660096">-</font><font color="#000000"> (legalPolicyIntensity </font><font color="#660096">/</font><font color="#000000"> </font><font color="#963700">100</font><font color="#000000">))<br />    ]<br />    </font><font color="#0000aa">ask</font><font color="#000000"> people [<br />      </font><font color="#0000aa">if</font><font color="#000000"> group </font><font color="#660096">=</font><font color="#000000"> </font><font color="#963700">&quot;A&quot;</font><font color="#000000"> [<br />        </font><font color="#0000aa">set</font><font color="#000000"> prejudice prejudice </font><font color="#660096">*</font><font color="#000000"> (</font><font color="#963700">1</font><font color="#000000"> </font><font color="#660096">-</font><font color="#000000"> (trainingIntensity </font><font color="#660096">/</font><font color="#000000"> </font><font color="#963700">100</font><font color="#000000">))<br />      ]<br />    ]<br />    </font><font color="#0000aa">ask</font><font color="#000000"> </font><font color="#660096">patches</font><font color="#000000"> </font><font color="#660096">with</font><font color="#000000"> [</font><font color="#660096">pcolor</font><font color="#000000"> </font><font color="#660096">=</font><font color="#000000"> </font><font color="#963700">lime</font><font color="#000000"> </font><font color="#660096">or</font><font color="#000000"> </font><font color="#660096">pcolor</font><font color="#000000"> </font><font color="#660096">=</font><font color="#000000"> </font><font color="#963700">yellow</font><font color="#000000">] [<br />      </font><font color="#0000aa">ask</font><font color="#000000"> people-here [<br />        </font><font color="#0000aa">let</font><font color="#000000"> neighbor </font><font color="#660096">one-of</font><font color="#000000"> </font><font color="#660096">other</font><font color="#000000"> people-here<br />        </font><font color="#0000aa">if</font><font color="#000000"> neighbor </font><font color="#660096">!=</font><font color="#000000"> </font><font color="#963700">nobody</font><font color="#000000"> </font><font color="#660096">and</font><font color="#000000"> group </font><font color="#660096">!=</font><font color="#000000"> [group] </font><font color="#660096">of</font><font color="#000000"> neighbor [<br />          </font><font color="#0000aa">set</font><font color="#000000"> prejudice prejudice </font><font color="#660096">*</font><font color="#000000"> (</font><font color="#963700">1</font><font color="#000000"> </font><font color="#660096">-</font><font color="#000000"> (communityEventIntensity </font><font color="#660096">/</font><font color="#000000"> </font><font color="#963700">100</font><font color="#000000">))<br />        ]<br />      ]<br />    ]<br />    </font><font color="#0000aa">ask</font><font color="#000000"> people </font><font color="#660096">with</font><font color="#000000"> [economic-status </font><font color="#660096">&lt;</font><font color="#000000"> </font><font color="#963700">50</font><font color="#000000">] [<br />      </font><font color="#0000aa">set</font><font color="#000000"> prejudice prejudice </font><font color="#660096">*</font><font color="#000000"> (</font><font color="#963700">1</font><font color="#000000"> </font><font color="#660096">-</font><font color="#000000"> (economicIncentiveIntensity </font><font color="#660096">/</font><font color="#000000"> </font><font color="#963700">100</font><font color="#000000">))<br />    ]<br />    </font><font color="#0000aa">ask</font><font color="#000000"> people [<br />      </font><font color="#0000aa">if</font><font color="#000000"> group </font><font color="#660096">!=</font><font color="#000000"> </font><font color="#963700">&quot;A&quot;</font><font color="#000000"> [<br />        </font><font color="#0000aa">set</font><font color="#000000"> prejudice prejudice </font><font color="#660096">*</font><font color="#000000"> (</font><font color="#963700">1</font><font color="#000000"> </font><font color="#660096">-</font><font color="#000000"> (sharedResourceIntensity </font><font color="#660096">/</font><font color="#000000"> </font><font color="#963700">100</font><font color="#000000">))<br />      ]<br />    ]<br />    </font><font color="#0000aa">ask</font><font color="#000000"> people </font><font color="#660096">with</font><font color="#000000"> [age </font><font color="#660096">&lt;</font><font color="#000000"> </font><font color="#963700">18</font><font color="#000000">] [<br />      </font><font color="#0000aa">set</font><font color="#000000"> prejudice prejudice </font><font color="#660096">*</font><font color="#000000"> (</font><font color="#963700">1</font><font color="#000000"> </font><font color="#660096">-</font><font color="#000000"> (youthSocializationIntensity </font><font color="#660096">/</font><font color="#000000"> </font><font color="#963700">100</font><font color="#000000">))<br />    ]<br />  ]<br /></font><font color="#007f69">end</font><font color="#000000"><br /><br /></font><font color="#5a5a5a">; ------------------------------</font><font color="#000000"><br /></font><font color="#5a5a5a">; Reset counters each tick</font><font color="#000000"><br /></font><font color="#007f69">to</font><font color="#000000"> clear-stats<br />  </font><font color="#0000aa">set</font><font color="#000000"> meet </font><font color="#963700">0</font><font color="#000000"><br />  </font><font color="#0000aa">set</font><font color="#000000"> coopown </font><font color="#963700">0</font><font color="#000000"><br />  </font><font color="#0000aa">set</font><font color="#000000"> coopother </font><font color="#963700">0</font><font color="#000000"><br />  </font><font color="#0000aa">set</font><font color="#000000"> defother </font><font color="#963700">0</font><font color="#000000"><br />  </font><font color="#0000aa">set</font><font color="#000000"> defown </font><font color="#963700">0</font><font color="#000000"><br /></font><font color="#007f69">end</font><font color="#000000"><br /><br /><br /></font><font color="#5a5a5a">; ------------------------------</font><font color="#000000"><br /></font><font color="#5a5a5a">; Update statistics</font><font color="#000000"><br /></font><font color="#007f69">to</font><font color="#000000"> update-stats<br />  </font><font color="#0000aa">set</font><font color="#000000"> meet-agg meet-agg </font><font color="#660096">+</font><font color="#000000"> meet<br />  </font><font color="#0000aa">set</font><font color="#000000"> coopown-agg coopown-agg </font><font color="#660096">+</font><font color="#000000"> coopown<br />  </font><font color="#0000aa">set</font><font color="#000000"> coopother-agg coopother-agg </font><font color="#660096">+</font><font color="#000000"> coopother<br />  </font><font color="#0000aa">set</font><font color="#000000"> defother-agg defother-agg </font><font color="#660096">+</font><font color="#000000"> defother<br />  </font><font color="#0000aa">set</font><font color="#000000"> defown-agg defown-agg </font><font color="#660096">+</font><font color="#000000"> defown<br /><br />  </font><font color="#0000aa">if</font><font color="#000000"> </font><font color="#660096">any?</font><font color="#000000"> people </font><font color="#660096">with</font><font color="#000000"> [group </font><font color="#660096">=</font><font color="#000000"> </font><font color="#963700">&quot;A&quot;</font><font color="#000000">] [<br />    </font><font color="#0000aa">set</font><font color="#000000"> avg-prejudice-group-A </font><font color="#660096">mean</font><font color="#000000"> [prejudice] </font><font color="#660096">of</font><font color="#000000"> people </font><font color="#660096">with</font><font color="#000000"> [group </font><font color="#660096">=</font><font color="#000000"> </font><font color="#963700">&quot;A&quot;</font><font color="#000000">]<br />  ]<br />  </font><font color="#0000aa">if</font><font color="#000000"> </font><font color="#660096">not</font><font color="#000000"> </font><font color="#660096">any?</font><font color="#000000"> people </font><font color="#660096">with</font><font color="#000000"> [group </font><font color="#660096">=</font><font color="#000000"> </font><font color="#963700">&quot;A&quot;</font><font color="#000000">] [ </font><font color="#0000aa">set</font><font color="#000000"> avg-prejudice-group-A </font><font color="#963700">0</font><font color="#000000"> ]<br /><br />  </font><font color="#0000aa">if</font><font color="#000000"> </font><font color="#660096">any?</font><font color="#000000"> people </font><font color="#660096">with</font><font color="#000000"> [group </font><font color="#660096">=</font><font color="#000000"> </font><font color="#963700">&quot;B&quot;</font><font color="#000000">] [<br />    </font><font color="#0000aa">set</font><font color="#000000"> avg-prejudice-group-B </font><font color="#660096">mean</font><font color="#000000"> [prejudice] </font><font color="#660096">of</font><font color="#000000"> people </font><font color="#660096">with</font><font color="#000000"> [group </font><font color="#660096">=</font><font color="#000000"> </font><font color="#963700">&quot;B&quot;</font><font color="#000000">]<br />  ]<br />  </font><font color="#0000aa">if</font><font color="#000000"> </font><font color="#660096">not</font><font color="#000000"> </font><font color="#660096">any?</font><font color="#000000"> people </font><font color="#660096">with</font><font color="#000000"> [group </font><font color="#660096">=</font><font color="#000000"> </font><font color="#963700">&quot;B&quot;</font><font color="#000000">] [ </font><font color="#0000aa">set</font><font color="#000000"> avg-prejudice-group-B </font><font color="#963700">0</font><font color="#000000"> ]<br /><br />  </font><font color="#0000aa">if</font><font color="#000000"> </font><font color="#660096">any?</font><font color="#000000"> people </font><font color="#660096">with</font><font color="#000000"> [group </font><font color="#660096">=</font><font color="#000000"> </font><font color="#963700">&quot;C&quot;</font><font color="#000000">] [<br />    </font><font color="#0000aa">set</font><font color="#000000"> avg-prejudice-group-C </font><font color="#660096">mean</font><font color="#000000"> [prejudice] </font><font color="#660096">of</font><font color="#000000"> people </font><font color="#660096">with</font><font color="#000000"> [group </font><font color="#660096">=</font><font color="#000000"> </font><font color="#963700">&quot;C&quot;</font><font color="#000000">]<br />  ]<br />  </font><font color="#0000aa">if</font><font color="#000000"> </font><font color="#660096">not</font><font color="#000000"> </font><font color="#660096">any?</font><font color="#000000"> people </font><font color="#660096">with</font><font color="#000000"> [group </font><font color="#660096">=</font><font color="#000000"> </font><font color="#963700">&quot;C&quot;</font><font color="#000000">] [ </font><font color="#0000aa">set</font><font color="#000000"> avg-prejudice-group-C </font><font color="#963700">0</font><font color="#000000"> ]<br /><br />  </font><font color="#0000aa">if</font><font color="#000000"> </font><font color="#660096">any?</font><font color="#000000"> people </font><font color="#660096">with</font><font color="#000000"> [group </font><font color="#660096">=</font><font color="#000000"> </font><font color="#963700">&quot;D&quot;</font><font color="#000000">] [<br />    </font><font color="#0000aa">set</font><font color="#000000"> avg-prejudice-group-D </font><font color="#660096">mean</font><font color="#000000"> [prejudice] </font><font color="#660096">of</font><font color="#000000"> people </font><font color="#660096">with</font><font color="#000000"> [group </font><font color="#660096">=</font><font color="#000000"> </font><font color="#963700">&quot;D&quot;</font><font color="#000000">]<br />  ]<br />  </font><font color="#0000aa">if</font><font color="#000000"> </font><font color="#660096">not</font><font color="#000000"> </font><font color="#660096">any?</font><font color="#000000"> people </font><font color="#660096">with</font><font color="#000000"> [group </font><font color="#660096">=</font><font color="#000000"> </font><font color="#963700">&quot;D&quot;</font><font color="#000000">] [ </font><font color="#0000aa">set</font><font color="#000000"> avg-prejudice-group-D </font><font color="#963700">0</font><font color="#000000"> ]<br /><br />  </font><font color="#0000aa">if</font><font color="#000000"> </font><font color="#660096">any?</font><font color="#000000"> people </font><font color="#660096">with</font><font color="#000000"> [group </font><font color="#660096">=</font><font color="#000000"> </font><font color="#963700">&quot;E&quot;</font><font color="#000000">] [<br />    </font><font color="#0000aa">set</font><font color="#000000"> avg-prejudice-group-E </font><font color="#660096">mean</font><font color="#000000"> [prejudice] </font><font color="#660096">of</font><font color="#000000"> people </font><font color="#660096">with</font><font color="#000000"> [group </font><font color="#660096">=</font><font color="#000000"> </font><font color="#963700">&quot;E&quot;</font><font color="#000000">]<br />  ]<br />  </font><font color="#0000aa">if</font><font color="#000000"> </font><font color="#660096">not</font><font color="#000000"> </font><font color="#660096">any?</font><font color="#000000"> people </font><font color="#660096">with</font><font color="#000000"> [group </font><font color="#660096">=</font><font color="#000000"> </font><font color="#963700">&quot;E&quot;</font><font color="#000000">] [ </font><font color="#0000aa">set</font><font color="#000000"> avg-prejudice-group-E </font><font color="#963700">0</font><font color="#000000"> ]<br /></font><font color="#007f69">end</font><font color="#000000"><br /></font>
</pre>
